{% extends "base.html" %}
{% block content %}

<div id="control">


</div>

{% endblock %}

{% block extra_styles %}
{% endblock %}

{% block extra_end_scripts %}


<script>

	function init_item(name, data) {
		let items = []
		let label_txt = build_label(name);
		let label_val = build_label(data[name]);
		let control = build_control(name, data[name], label_val);

		items.push(label_txt);
		items.push(control);
		items.push(label_val);

		return items
	};

	function build_label(val) {
		let label = document.createElement('output');
		label.type = 'label';
		label.value = val;
		return label
	}

	function build_control(name, val, label_val) {
		let control = document.createElement('input');
		control.type = "range";
		control.value = val;
		control.addEventListener("change", function () {
			let val = control.value
			$.get('/feature/' + name + '/' + val, function (val, status) {
				label_val.value = val.result
			});
		});
		return control
	}

	function build_page() {
		$.get('/data/', function (data, status) {
			let features = []
			for (var key in data) {
				let feature = init_item(key, data);
				features.push(feature);
			};
			let tbl = tableCreate(features);
		});
	}

	function tableCreate(features) {
		const body = document.body,
			tbl = document.createElement('table');
		tbl.style.width = '100px';
		for (let row = 0; row < features.length; row++) {
			const tr = tbl.insertRow();
			for (let item = 0; item < features[row].length; item++) {
				const td = tr.insertCell();
				td.appendChild(features[row][item]);
				td.setAttribute('rowSpan', '1');
			};
		};
		document.getElementById('control').appendChild(tbl);
	}

	window.onload = build_page

</script>

{% endblock %}